<!-- Start of globalprofessionalsearch Zendesk Widget script -->
<script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("//assets.zendesk.com/embeddable_framework/main.js","globalprofessionalsearch.zendesk.com");/*]]>*/</script>
<!-- End of globalprofessionalsearch Zendesk Widget script -->

<!-- BEGIN configure zendesk widget -->
<script>

  // custom controller for custom zendesk help button
  var GpsHelpButton = (function() {
    function GpsHelpButton(elem) {
      this.elem = elem;
      this.visible = true;
      this.elem.bind('click', this.activate);
    }

    GpsHelpButton.prototype.activate = function() {
      return zE(function() {
        return zE.activate({
          hideOnClose: true
        });
      });
    };

    GpsHelpButton.prototype.deactivate = function() {
      return zE(function() {
        return zE.hide();
      });
    };

    GpsHelpButton.prototype.show = function() {
      this.visible = true;
      return this.elem.show();
    };

    GpsHelpButton.prototype.hide = function() {
      this.visible = false;
      return this.elem.hide();
    };

    GpsHelpButton.prototype.toggleVisibility = function() {
      if (this.visible) {
        return this.hide();
      } else {
        return this.show();
      }
    };

    return GpsHelpButton;

  })();


  zE(function() {
    // force hide the widget, we use our own custom button for activating/hiding
    // the web widget
    zE.hide();

    // Identify user w/ zenddesk if authenticated
    {% if app.user and is_granted('IS_AUTHENTICATED_REMEMBERED') %}
    zE.identify({
      name: "{{app.user.getFirstName()}} {{app.user.getLastName()}}",
      email: "{{app.user.getEmail()}}",
      externalId: "{{app.user.getId()}}"
    });
    {% endif %}
  });

</script>
<!-- END configure zendesk widget -->
